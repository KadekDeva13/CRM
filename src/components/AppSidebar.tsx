import { type ReactNode } from "react";
import { NavLink } from "react-router-dom";

type SidebarProps = {
  collapsed?: boolean;
  openMobile?: boolean;
  onCloseMobile?: () => void;
};

export default function AppSidebar({
  collapsed = false,
  openMobile = false,
  onCloseMobile,
}: SidebarProps) {
  return (
    <>
      <div
        className={[
          "fixed inset-0 z-40 bg-black/40 transition-opacity md:hidden",
          openMobile ? "opacity-100 pointer-events-auto" : "opacity-0 pointer-events-none",
        ].join(" ")}
        onClick={onCloseMobile}
      />

      <aside
        className={[
          "fixed left-0 top-0 z-50 h-svh",
          "bg-[#1a1a1a] border-r border-white/5",
          "transition-[transform,width]",
          openMobile ? "translate-x-0" : "-translate-x-full", 
          "md:translate-x-0",                                 
          collapsed ? "w-[76px]" : "w-64",
        ].join(" ")}
        role="complementary"
        aria-label="Sidebar"
      >
        
        <div className="pt-16 h-full flex flex-col">
            <div className="flex items-center gap-3 font-helectiva mb-5">
              <img
                src="/image/Guirez.png"
                alt="guirez"
                className={collapsed ? "h-6 w-auto" : "h-7 w-auto"}
                draggable={false}
              />
              {!collapsed && (
                <>
                  <span className="text-white/50 text-lg leading-none">|</span>
                  <span className="tracking-[0.18em] text-sm">CRM</span>
                </>
              )}
            </div>
          <div className="px-3 py-4 text-sm text-white/70">
   

            {!collapsed && (
              <div className="mb-4 grid grid-cols-2 px-1 text-[12px] text-white/30">
                <div>Favorites</div>
                <div className="text-right">Recently</div>
              </div>
            )}
          </div>


          <div className="flex-1 overflow-y-auto px-3 text-sm text-white/70">
            <div className="mb-5 space-y-1">
              <NavItem to="/overeview" collapsed={collapsed} onClick={onCloseMobile}>
                <span className="mr-2 inline-flex">
                  <Dot6 />
                </span>
                {!collapsed && <span>Overview</span>}
              </NavItem>

              <NavItem to="/leads" collapsed={collapsed} onClick={onCloseMobile}>
                <span className="mr-2 inline-flex">
                  <Dot6 />
                </span>
                {!collapsed && <span>Leads</span>}
              </NavItem>
            </div>

            <SectionHeader hidden={collapsed}>Dashboards</SectionHeader>

            <div className="mb-5 space-y-1">
              <NavItem to="/overeview" collapsed={collapsed} onClick={onCloseMobile}>
                <span className="mr-3 inline-flex">
                  <IconOverview />
                </span>
                {!collapsed && <span>Overview</span>}
              </NavItem>

              <NavItem to="/projects" collapsed={collapsed} onClick={onCloseMobile}>
                <span className="mr-3 inline-flex">
                  <IconProjects />
                </span>
                {!collapsed && <span>Projects</span>}
              </NavItem>

              <NavItem to="/leads" collapsed={collapsed} onClick={onCloseMobile}>
                <span className="mr-3 inline-flex">
                  <IconLeads />
                </span>
                {!collapsed && <span>Leads</span>}
              </NavItem>

              <NavItem to="/guests" collapsed={collapsed} onClick={onCloseMobile}>
                <span className="mr-3 inline-flex">
                  <IconGuest />
                </span>
                {!collapsed && <span>Guests</span>}
              </NavItem>

              <NavItem to="/contacts" collapsed={collapsed} onClick={onCloseMobile}>
                <span className="mr-3 inline-flex">
                  <IconContacts />
                </span>
                {!collapsed && <span>Contacts</span>}
              </NavItem>
            </div>
          </div>
        </div>
      </aside>
    </>
  );
}

function SectionHeader({ hidden, children }: { hidden?: boolean; children: ReactNode }) {
  if (hidden) return null;
  return (
    <div className="mb-1 px-5 text-[11px] font-medium uppercase tracking-wide text-white/30">
      {children}
    </div>
  );
}

type NavItemProps = {
  to: string;
  children: ReactNode;
  collapsed?: boolean;
  onClick?: () => void;
};

function NavItem({ to, children, collapsed, onClick }: NavItemProps) {
  return (
    <NavLink
      to={to}
      onClick={onClick}
      className={({ isActive }: { isActive: boolean }) =>
        [
          "flex items-center rounded-md px-2 py-2",
          collapsed ? "justify-center" : "gap-2",
          isActive ? "bg-white/10 text-white" : "text-white/70 hover:bg-white/5 hover:text-white",
        ].join(" ")
      }
    >
      {children}
    </NavLink>
  );
}

function Dot6() {
  return (
    <svg width="6" height="6" viewBox="0 0 6 6" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M6 3C6 4.65685 4.65685 6 3 6C1.34315 6 0 4.65685 0 3C0 1.34315 1.34315 0 3 0C4.65685 0 6 1.34315 6 3Z" fill="white" fillOpacity="0.2" />
    </svg>
  );
}

function IconOverview() {
  return (
    <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M6.81261 8.09609C6.90765 8.04123 6.98656 7.96231 7.04142 7.86727C7.09627 7.77223 7.12514 7.66442 7.12511 7.55469V1.92969C7.12456 1.83004 7.10018 1.73198 7.05402 1.64367C7.00786 1.55536 6.94126 1.47936 6.85976 1.42202C6.77826 1.36469 6.68424 1.32766 6.58553 1.31405C6.48681 1.30043 6.38628 1.31062 6.2923 1.34375C4.46807 1.98939 2.93396 3.26457 1.96575 4.94005C0.997549 6.61554 0.658754 8.58145 1.01027 10.4844C1.02849 10.5828 1.07008 10.6754 1.13153 10.7544C1.19298 10.8333 1.27249 10.8964 1.3634 10.9383C1.44531 10.9766 1.53468 10.9963 1.62511 10.9961C1.73481 10.9961 1.84259 10.9673 1.93761 10.9125L6.81261 8.09609ZM5.87511 2.87656V7.19375L2.13449 9.35234C2.12511 9.23438 2.12511 9.11563 2.12511 9C2.12622 7.73309 2.4769 6.49106 3.13855 5.41066C3.80019 4.33025 4.74713 3.45337 5.87511 2.87656ZM17.1251 9C17.1257 10.7837 16.5394 12.518 15.4565 13.9354C14.3737 15.3528 12.8545 16.3745 11.1334 16.8428C9.41224 17.3111 7.58484 17.2 5.9331 16.5267C4.28137 15.8534 2.8971 14.6553 1.99386 13.1172C1.95176 13.0461 1.92415 12.9675 1.91263 12.8857C1.90112 12.8039 1.90592 12.7207 1.92677 12.6407C1.94762 12.5608 1.9841 12.4859 2.0341 12.4201C2.0841 12.3544 2.14664 12.2992 2.21808 12.2578L8.37511 8.67422V1.5C8.37511 1.33424 8.44096 1.17527 8.55817 1.05806C8.67538 0.940848 8.83435 0.875 9.00011 0.875C10.418 0.875723 11.811 1.24729 13.0409 1.95282C14.2707 2.65834 15.2947 3.67328 16.0111 4.89688C16.759 6.20247 17.1269 7.58916 17.1251 9Z" fill="white" />
    </svg>
  );
}

function IconProjects() {
  return (
    <svg width="18" height="14" viewBox="0 0 18 14" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M15.875 2.625H9.20859L7.04141 1C6.82472 0.838324 6.56176 0.750671 6.29141 0.75H2.125C1.79348 0.75 1.47554 0.881696 1.24112 1.11612C1.0067 1.35054 0.875 1.66848 0.875 2V12.625C0.875 12.9565 1.0067 13.2745 1.24112 13.5089C1.47554 13.7433 1.79348 13.875 2.125 13.875H15.875C16.2065 13.875 16.5245 13.7433 16.7589 13.5089C16.9933 13.2745 17.125 12.9565 17.125 12.625V3.875C17.125 3.54348 16.9933 3.22554 16.7589 2.99112C16.5245 2.7567 16.2065 2.625 15.875 2.625ZM2.125 2H6.29141L7.95859 3.25L6.29141 4.5H2.125V2ZM15.875 12.625H2.125V5.75H6.29141C6.56176 5.74933 6.82472 5.66168 7.04141 5.5L9.20859 3.875H15.875V12.625Z" fill="white" />
    </svg>
  );
}

function IconGuest() {
  return (
    <svg width="20" height="12" viewBox="0 0 20 12" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M11.8751 2.2502C11.8751 2.08444 11.941 1.92547 12.0582 1.80826C12.1754 1.69105 12.3344 1.6252 12.5001 1.6252H19.3751C19.5409 1.6252 19.6998 1.69105 19.8171 1.80826C19.9343 1.92547 20.0001 2.08444 20.0001 2.2502C20.0001 2.41596 19.9343 2.57493 19.8171 2.69214C19.6998 2.80935 19.5409 2.8752 19.3751 2.8752H12.5001C12.3344 2.8752 12.1754 2.80935 12.0582 2.69214C11.941 2.57493 11.8751 2.41596 11.8751 2.2502ZM19.3751 5.3752H12.5001C12.3344 5.3752 12.1754 5.44105 12.0582 5.55826C11.941 5.67547 11.8751 5.83444 11.8751 6.0002C11.8751 6.16596 11.941 6.32493 12.0582 6.44214C12.1754 6.55935 12.3344 6.6252 12.5001 6.6252H19.3751C19.5409 6.6252 19.6998 6.55935 19.8171 6.44214C19.9343 6.32493 20.0001 6.16596 20.0001 6.0002C20.0001 5.83444 19.9343 5.67547 19.8171 5.55826C19.6998 5.44105 19.5409 5.3752 19.3751 5.3752ZM19.3751 9.1252H14.3751C14.2094 9.1252 14.0504 9.19105 13.9332 9.30826C13.816 9.42547 13.7501 9.58444 13.7501 9.7502C13.7501 9.91596 13.816 10.0749 13.9332 10.1921C14.0504 10.3094 14.2094 10.3752 14.3751 10.3752H19.3751C19.5409 10.3752 19.6998 10.3094 19.8171 10.1921C19.9343 10.0749 20.0001 9.91596 20.0001 9.7502C20.0001 9.58444 19.9343 9.42547 19.8171 9.30826C19.6998 9.19105 19.5409 9.1252 19.3751 9.1252ZM11.8556 10.844C11.876 10.9235 11.8806 11.0062 11.869 11.0875C11.8575 11.1688 11.83 11.247 11.7882 11.3176C11.7464 11.3883 11.6911 11.45 11.6255 11.4993C11.5598 11.5486 11.4851 11.5845 11.4056 11.6049C11.3546 11.6186 11.3021 11.6254 11.2493 11.6252C11.1107 11.6253 10.976 11.5793 10.8664 11.4944C10.7568 11.4095 10.6785 11.2907 10.6439 11.1565C10.1626 9.28614 8.27355 7.8752 6.24933 7.8752C4.22511 7.8752 2.33605 9.28536 1.8548 11.1565C1.81336 11.317 1.70983 11.4546 1.56698 11.5388C1.42413 11.6231 1.25366 11.6471 1.09308 11.6057C0.9325 11.5642 0.794959 11.4607 0.710714 11.3178C0.626469 11.175 0.602421 11.0045 0.643862 10.844C1.08058 9.14786 2.35011 7.77442 3.96105 7.09395C3.34076 6.61619 2.88557 5.95625 2.65932 5.2067C2.43306 4.45715 2.4471 3.65558 2.69944 2.91441C2.95179 2.17324 3.4298 1.52964 4.06643 1.07388C4.70306 0.618113 5.46638 0.373047 6.24933 0.373047C7.03228 0.373047 7.7956 0.618113 8.43223 1.07388C9.06886 1.52964 9.54687 2.17324 9.79922 2.91441C10.0516 3.65558 10.0656 4.45715 9.83934 5.2067C9.61309 5.95625 9.1579 6.61619 8.53761 7.09395C10.1493 7.77442 11.4189 9.14786 11.8556 10.844ZM6.25011 6.6252C6.74457 6.6252 7.22791 6.47858 7.63904 6.20387C8.05016 5.92917 8.37059 5.53872 8.55981 5.08191C8.74903 4.62509 8.79854 4.12243 8.70208 3.63748C8.60561 3.15252 8.36751 2.70706 8.01788 2.35743C7.66825 2.0078 7.22279 1.7697 6.73784 1.67324C6.25288 1.57677 5.75022 1.62628 5.2934 1.8155C4.83659 2.00472 4.44614 2.32515 4.17144 2.73628C3.89673 3.1474 3.75011 3.63075 3.75011 4.1252C3.75011 4.78824 4.0135 5.42413 4.48234 5.89297C4.95119 6.36181 5.58707 6.6252 6.25011 6.6252Z" fill="white" />
    </svg>
  );
}

function IconContacts() {
  return (
    <svg width="17" height="15" viewBox="0 0 17 15" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M15.375 0.625H1.625C1.29348 0.625 0.975537 0.756696 0.741116 0.991116C0.506696 1.22554 0.375 1.54348 0.375 1.875V13.125C0.375 13.4565 0.506696 13.7745 0.741116 14.0089C0.975537 14.2433 1.29348 14.375 1.625 14.375H15.375C15.7065 14.375 16.0245 14.2433 16.2589 14.0089C16.4933 13.7745 16.625 13.4565 16.625 13.125V1.875C16.625 1.54348 16.4933 1.22554 16.2589 0.991116C16.0245 0.756696 15.7065 0.625 15.375 0.625ZM6 6.875C6 6.38055 6.14662 5.8972 6.42133 5.48607C6.69603 5.07495 7.08648 4.75452 7.54329 4.5653C8.00011 4.37608 8.50277 4.32657 8.98773 4.42304C9.47268 4.5195 9.91814 4.7576 10.2678 5.10723C10.6174 5.45686 10.8555 5.90232 10.952 6.38727C11.0484 6.87223 10.9989 7.37489 10.8097 7.83171C10.6205 8.28852 10.3 8.67897 9.88893 8.95367C9.4778 9.22838 8.99445 9.375 8.5 9.375C7.83696 9.375 7.20107 9.11161 6.73223 8.64277C6.26339 8.17393 6 7.53804 6 6.875ZM4.16953 13.125C4.60833 12.3647 5.23954 11.7334 5.9997 11.2945C6.75987 10.8555 7.6222 10.6244 8.5 10.6244C9.3778 10.6244 10.2401 10.8555 11.0003 11.2945C11.7605 11.7334 12.3917 12.3647 12.8305 13.125H4.16953ZM15.375 13.125H14.2289C13.5692 11.6184 12.3431 10.4318 10.8156 9.82187C11.4291 9.34023 11.8772 8.67926 12.0974 7.93099C12.3177 7.18273 12.2991 6.38442 12.0443 5.64721C11.7895 4.91001 11.3111 4.27061 10.6759 3.81803C10.0406 3.36545 9.28 3.12223 8.5 3.12223C7.72 3.12223 6.95942 3.36545 6.32415 3.81803C5.68888 4.27061 5.21054 4.91001 4.95573 5.64721C4.70093 6.38442 4.68234 7.18273 4.90257 7.93099C5.12279 8.67926 5.57085 9.34023 6.18437 9.82187C4.65692 10.4318 3.43082 11.6184 2.77109 13.125H1.625V1.875H15.375V13.125Z" fill="white" />
    </svg>
  );
}

function IconLeads() {
  return (
    <svg width="18" height="14" viewBox="0 0 18 14" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M15.875 0.46875H2.125C1.79348 0.46875 1.47554 0.593861 1.24112 0.816561C1.0067 1.03926 0.875 1.34131 0.875 1.65625V12.3438C0.875 12.6587 1.0067 12.9607 1.24112 13.1834C1.47554 13.4061 1.79348 13.5312 2.125 13.5312H15.875C16.2065 13.5312 16.5245 13.4061 16.7589 13.1834C16.9933 12.9607 17.125 12.6587 17.125 12.3438V1.65625C17.125 1.34131 16.9933 1.03926 16.7589 0.816561C16.5245 0.593861 16.2065 0.46875 15.875 0.46875ZM15.875 1.65625V2.84375H2.125V1.65625H15.875ZM15.875 12.3438H2.125V4.03125H15.875V12.3438ZM12.75 5.8125C12.75 6.75733 12.3549 7.66347 11.6517 8.33157C10.9484 8.99967 9.99456 9.375 9 9.375C8.00544 9.375 7.05161 8.99967 6.34835 8.33157C5.64509 7.66347 5.25 6.75733 5.25 5.8125C5.25 5.65503 5.31585 5.504 5.43306 5.39266C5.55027 5.28131 5.70924 5.21875 5.875 5.21875C6.04076 5.21875 6.19973 5.28131 6.31694 5.39266C6.43415 5.504 6.5 5.65503 6.5 5.8125C6.5 6.44239 6.76339 7.04648 7.23223 7.49188C7.70107 7.93728 8.33696 8.1875 9 8.1875C9.66304 8.1875 10.2989 7.93728 10.7678 7.49188C11.2366 7.04648 11.5 6.44239 11.5 5.8125C11.5 5.65503 11.5658 5.504 11.6831 5.39266C11.8003 5.28131 11.9592 5.21875 12.125 5.21875C12.2908 5.21875 12.4497 5.28131 12.5669 5.39266C12.6842 5.504 12.75 5.65503 12.75 5.8125Z" fill="#FDFDFD" />
    </svg>
  );
}
